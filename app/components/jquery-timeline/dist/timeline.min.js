/* jquery-timeline v0.3.1 | (c) 2015 Sergey Mashentsev <d.ashesss@gmail.com> | MIT License */
"use strict";var JQueryTimeline;!function(t){t.$;var e=function(){function e(n){if(this.lines=[],!(this instanceof e))return new e(n);n=t.$.extend(!0,{},e.defaultOptions,n),n.container&&n.container.length||(n.container=t.$("<div>"));var i=n.container.data("timeline");if(i)throw i;this.$=n.container.addClass("jquery-timeline").data("timeline",this),this.$background=t.$("<div>",{"class":"background"}).appendTo(this.$),this.$content=t.$("<div>",{"class":"content"}).appendTo(this.$),this.initScroll();var r=e.zoomBase/n.minorSections;this.zoom=n.zoom,this.zoom<=0?this.zoom=1:this.zoom>r&&(this.zoom=r),this.yearScale=e.yearScale*n.scale,this.minorSections=n.minorSections,n.lines=n.lines||[],n.events&&n.lines.push({events:n.events}),n.lines.forEach(this._addLine,this),this.render()}return e.roundYear=function(t,e,n){void 0===e&&(e=10),void 0===n&&(n=!1);var i=t/e;return i=n?Math.ceil(i):Math.floor(i),0===i?0:i*e},e.prototype.initScroll=function(){var e=this;this.$.bind("mousewheel",function(t){t.preventDefault(),e.scroll(t.originalEvent.deltaY)}),this.$.bind("DOMMouseScroll",function(t){var n=t;n.preventDefault(),e.scroll(20*n.detail)}),this.$.data("scroll",!1),this.$.mousedown(function(t){if(0===t.button){var n=setTimeout(function(){e.$.data("scroll",t.pageX).addClass("dragging")},50);e.$.data("scroll-timeout",n)}}),t.$(document).mousemove(function(t){var n=e.$.data("scroll");n!==!1&&(e.scroll(n-t.pageX),e.$.data("scroll",t.pageX))}),t.$(document).mouseup(function(){e.$.data("scroll",!1).removeClass("dragging"),clearTimeout(e.$.data("scroll-timeout"))})},e.prototype.addLine=function(t){var e=this._addLine(t);return this.render(),e},e.prototype._addLine=function(e){e=t.$.extend(!0,{},e);var n=new t.Line(e);return this.$content.append(n.$),this.lines.push(n),n},e.prototype.addEvent=function(t,e){var n=this._addEvent(t,e);return this.render(),n},e.prototype.addEvents=function(t,e){t.forEach(function(t){this._addEvent(t,e)},this),this.render()},e.prototype._addEvent=function(e,n){return e=t.$.extend(!0,{},e),"undefined"==typeof n&&(0===this.lines.length&&this._addLine(),n=this.lines.length-1),"undefined"!=typeof this.lines[n]?this.lines[n].addEvent(e):void 0},e.prototype.render=function(){this.$background.empty();var t=this.getRenderOptions();0!==t.years.length&&(this.renderBackground(t),this.renderLines(t))},e.prototype.getRenderOptions=function(){var t=[];this.lines.forEach(function(e){t=t.concat(e.getYears())});var n=e.roundYear(e.zoomBase/this.zoom,this.minorSections),i=n/this.minorSections,r=e.roundYear(Math.min.apply(null,t),n,!1);r-=n;var o=e.roundYear(Math.max.apply(null,t),n,!0);return o+=i*(this.minorSections-1),{years:t,year_width:this.zoom*this.yearScale,major_step:n,minor_step:i,min_year:r,max_year:o}},e.prototype.renderBackground=function(e){var n;for(n=e.min_year;n<=e.max_year;n+=e.minor_step){var i=Math.round(e.minor_step*e.year_width),r=t.$("<div>",{"class":"period"}).width(i).appendTo(this.$background);n%e.major_step===0&&(r.addClass("solid"),t.$("<div>",{"class":"label",text:new t.EventDate(n).formatYearEpoch()}).appendTo(r))}this.scrollTo(e.min_year+e.major_step)},e.prototype.renderLines=function(t){this.lines.forEach(function(e){e.render(t)})},e.prototype.scroll=function(t){var e=this.$.scrollLeft();this.$.scrollLeft(e+t)},e.prototype.scrollTo=function(t){var e=this.getRenderOptions(),n=t-e.min_year;this.$.scrollLeft(n*e.year_width)},e.zoomBase=1e3,e.yearScale=.24,e.defaultOptions={zoom:100,scale:1,minorSections:5},e}();t.Timeline=e}(JQueryTimeline||(JQueryTimeline={}));var JQueryTimeline;!function(t){var e=function(){function e(n){this.children=[],this.$=t.$("<div>",{"class":"event",data:{event:this}}),this.$marker=t.$("<div>",{"class":"marker",css:{"background-color":n.color||e.defaultColor}}).appendTo(this.$),"transparent"===n.color&&this.$marker.addClass("border"),this.$label=t.$("<div>",{"class":"label",text:n.label}).appendTo(this.$),this.startDate=new t.EventDate(n.start),n.length?this.endDate=new t.EventDate(n.start,n.length):n.end&&(this.endDate=new t.EventDate(n.end)),this.$.addClass(this.isSingle()?"single":"range"),this.name=n.name||n.label||"",this.description=n.description||"",this.initTooltip()}return e.prototype.getStartYear=function(){return this.startDate.getYear()},e.prototype.getEndYear=function(){return this.endDate?this.endDate.getYear():this.getStartYear()},e.prototype.getLength=function(){return this.getEndYear()-this.getStartYear()},e.prototype.render=function(t){var e=(this.getStartYear()-t.min_year)*t.year_width;this.$.css("left",e);var n=this.getLength()*t.year_width;n>0&&this.$marker.width(n)},e.prototype.initTooltip=function(){var t=this;this.$.hover(function(e){t.showTooltip(e)},function(){t.hideTooltip()}).mousemove(function(e){t.showTooltip(e)}),this.$.click(function(e){t.showTooltip(e,!0)})},e.prototype.hideTooltip=function(){t.Tooltip.hide(),this.tooltip=null},e.prototype.showTooltip=function(e,n){void 0===n&&(n=!1),this.tooltip||(this.tooltip=this.tooltipContent()),t.Tooltip.show({content:this.tooltip,x:e.clientX,y:e.clientY,fixed:n})},e.prototype.tooltipContent=function(){var e=t.$("<div>").append(this.tooltipTitle());return this.description.length>0&&t.$("<div>",{"class":"content"}).html(this.description).appendTo(e),e.html()},e.prototype.tooltipTitle=function(){var e=[this].concat(this.children).reduce(function(e,n){var i=n.renderTooltipTitle(),r=n.getDateIndex();return"undefined"==typeof e[r]&&(e[r]=t.$("<div>")),e[r].append(i),e},[]);return e.reduce(function(t,e,n){return t.append(e)},t.$("<div>",{"class":"title"}))},e.prototype.renderTooltipTitle=function(){var e=t.$("<div>"),n=this.startDate.render(this.endDate);return t.$("<strong>").text(n+": ").appendTo(e),e.append(this.name),e},e.prototype.isSingle=function(){return 0===this.getLength()},e.prototype.isMergable=function(){return this.isSingle()&&0===this.description.length},e.prototype.addChild=function(t){this.children.push(t);var e=this.children.length+1;this.$label.text("("+e+" events)")},e.prototype.getDateIndex=function(){return this.startDate.getDateIndex()},e.defaultColor="gray",e}();t.Event=e}(JQueryTimeline||(JQueryTimeline={}));var JQueryTimeline;!function(t){var e=function(){function t(t,e){this.year=0;var n=!1;"number"==typeof t&&(t=t.toFixed(0)),"-"===t.substr(0,1)&&(t=t.substr(1),n=!0);var i;/^\d+$/.exec(t)?this.year=parseInt(t):(i=/^(\d+)-(\d+)$/.exec(t))?(this.month=parseInt(i[1]),this.year=parseInt(i[2])):(i=/^(\d+)-(\d+)-(\d+)$/.exec(t))&&(this.date=parseInt(i[1]),this.month=parseInt(i[2]),this.year=parseInt(i[3])),n&&(this.year*=-1),this.year+=e||0}return t.simplifyYear=function(t){var e=Math.abs(t),n=""+e;return e>=1e9?(e/=1e8,e=Math.round(e)/10,n=e+"B"):e>=1e6?(e/=1e5,e=Math.round(e)/10,n=e+"M"):e>=1e4&&(e/=1e5,e=Math.round(e)/10,n=e+"K"),n},t.formatRange=function(t,e){return t.getYear()<0&&0<=e.getYear()?t.formatEpoch()+" - "+e.formatEpoch():t.getYear()!==e.getYear()?t.formatYear()+" - "+e.formatEpoch():"undefined"==typeof t.getMonth()||"undefined"==typeof e.getMonth()?t.formatEpoch():t.getMonth()!==e.getMonth()?t.formatMonth()+" - "+e.formatEpoch():"undefined"==typeof t.getDate()||"undefined"==typeof e.getDate()?t.formatEpoch():t.getDate()+" - "+e.formatEpoch()},t.join=function(t){return t.join(" ").trim()},t.prototype.getDateIndex=function(){var t="0"+(this.date||"0"),e="0"+(this.month||"0");return parseInt(e.substr(-2)+t.substr(-2))},t.prototype.getDate=function(){return this.date},t.prototype.getMonth=function(){return this.month},t.prototype.getMonthName=function(){return"undefined"==typeof this.month?"":t.monthNames[this.month-1]},t.prototype.getYear=function(){return this.year},t.prototype.getEpoch=function(){return this.year<0?"BC":"AD"},t.prototype.formatMonth=function(){return t.join([this.getDate(),this.getMonthName()])},t.prototype.formatYear=function(){return t.join([this.formatMonth(),t.simplifyYear(this.getYear())])},t.prototype.formatEpoch=function(){return t.join([this.formatYear(),this.getEpoch()])},t.prototype.formatYearEpoch=function(){return t.join([t.simplifyYear(this.getYear()),this.getEpoch()])},t.prototype.render=function(e){return e?t.formatRange(this,e):this.formatEpoch()},t.monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t}();t.EventDate=e}(JQueryTimeline||(JQueryTimeline={}));var JQueryTimeline;!function(t){var e=function(){function e(e){var n=this;void 0===e&&(e={}),this.events=[],this.mergedEvents={},this.$=t.$("<div>",{"class":"line",data:{line:this}}),e.color&&(this.color=e.color);var i=e.events||[];i.forEach(function(t){n.addEvent(t)})}return e.prototype.addEvent=function(e){var n=this;e.color=e.color||this.color;var i=new t.Event(e);if(i.isMergable()){var r=i.getStartYear();if("undefined"!=typeof this.mergedEvents[r])return this.mergedEvents[r].addChild(i),i;this.mergedEvents[r]=i}var o=this.events.some(function(t,e){return t.getStartYear()<i.getStartYear()?!1:t.getStartYear()!==i.getStartYear()||!i.isSingle()&&t.isSingle()?(n.events.splice(e,0,i),!0):!1});return o||this.events.push(i),i},e.prototype.getYears=function(){var t=[];return this.events.forEach(function(e){t.push(e.getStartYear(),e.getEndYear())}),t},e.prototype.render=function(e){var n=this;this.$.find(".row").detach(),this.events.forEach(function(i){var r=n.$.find(".row").toArray().some(function(n){var r=(i.getStartYear()-e.min_year)*e.year_width,o=t.$(n).find(".event").last(),a=o.width()+parseFloat(o.css("left"));return r>a-10?(t.$(n).append(i.$),!0):void 0});r||t.$("<div>",{"class":"row"}).append(i.$).appendTo(n.$),i.render(e)})},e}();t.Line=e}(JQueryTimeline||(JQueryTimeline={}));var JQueryTimeline;!function(t){var e=function(){function e(){}return e.init=function(){return e.$=t.$("<div>",{"class":"jquery-timeline-tooltip"}).appendTo("body"),t.$("body").click(function(n){t.$(n.target).is(".event")||t.$(n.target).is(".jquery-timeline-tooltip")||t.$(n.target).parents(".event, .jquery-timeline-tooltip").length>0||e.hide(!0)}),e.$},e.show=function(t){var n=e.$||e.init();if(!n.is(".fixed")||t.fixed){if("undefined"!=typeof t.content&&n.html(t.content),"undefined"!=typeof t.x){var i=n.width();n.css("left",t.x-i/2)}"undefined"!=typeof t.y&&n.css("top",t.y+15),t.fixed&&n.addClass("fixed")}return n.show()},e.hide=function(t){return void 0===t&&(t=!1),!e.$.is(".fixed")||t?e.$.removeClass("fixed").hide():void 0},e}();t.Tooltip=e}(JQueryTimeline||(JQueryTimeline={})),function(t){JQueryTimeline.$=t,t.fn.timeline=function e(t,n){var e=this.data("timeline");if("string"==typeof t)return e instanceof JQueryTimeline.Timeline||(e=new JQueryTimeline.Timeline({container:this})),"function"==typeof e[t]&&e[t](n),this;var i=t||{};return e instanceof JQueryTimeline.Timeline||(i.container=this,e=new JQueryTimeline.Timeline(i)),e.$},t.timeline=function n(t){void 0===t&&(t={});var n=null;try{n=new JQueryTimeline.Timeline(t)}catch(e){e instanceof JQueryTimeline.Timeline&&(n=e)}return n}}(jQuery);
//# sourceMappingURL=timeline.min.js.map
